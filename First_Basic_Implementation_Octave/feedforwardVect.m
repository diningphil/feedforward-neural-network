function [prediction, net_of_output_units, net_of_hidden_units, out_of_hidden_units] = feedforwardVect(X, Theta1, Theta2, a)  % Assumes X has already been enriched with the 1's column  A1 = X'; % All the examples, transposed to obtain the same effects as with single columns    tmpH = Theta1*A1;    net_of_hidden_units = tmpH'; % the MATRIX of the HIDDEN units    A2 = sigmoid(a, tmpH);  A2 = [ones(1,size(A2,2)); A2]; % add bias  out_of_hidden_units = A2';    tmp = Theta2*A2;    net_of_output_units = tmp'; % the net of the OUT units in each row (for each pattern)    prediction = sigmoid(a, tmp)'; % transpose to return a prediction in each row (for each pattern)  end